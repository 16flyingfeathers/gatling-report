<head>
  <!-- script src="https://cdn.plot.ly/plotly-latest.min.js"></script-->
  <script src="file:///home/ben/dev/tools/gatling-report/src/main/resources/plotly-latest.min.js"></script>
</head>

<body>

<h1>{{simStat.scenario}} {{simStat.startDate}}</h1>

<div>Bench: {{simStat.scenario}}</div>
<div>Launched: {{simStat.startDate}}</div>
<div>Duration: {{simStat.duration}} seconds</div>
<div>Total requests: {{simStat.count}}</div>
<div>Average request per second: {{simStat.rps}}</div>

  <div id="totalDiv" style="width: 400px; height: 300px;"></div>
  <div id="responseDiv" style="width: 500px; height: 500px;"></div>
  <div id="allDiv" style="width: 1200px; height: 600px;"></div>

  <script>
var data = [{
  values: [{{simStat.successCount}}, {{simStat.errorCount}}],
  labels: ['Success', 'Error'],
  type: 'pie',
  marker: {
    //colors: ['rgb(56,75,126)', 'rgb(255,67,67)']
  }
}];
var layout = {
  height: 300,
  width: 400,
  title: '{{simStat.startDate}} {{simStat.scenario}} Errors',
};
Plotly.newPlot('totalDiv', data, layout);

var data = [
  {
    y: {{simStat.durations}},
    name: 'All ({{simStat.average}}ms)',
    boxpoints: 'all',
    jitter: 0.3,
    pointpos: -1.8,
    boxmean: 'sd',
    type: 'box',
    marker:{
      size:2,
      opacity:0.6
    }
  }
];

var layout = {
  height: 500,
  width: 500,
  yaxis: {
    title: 'Time ms',
    type: 'log'
  },
  showlegend: true,
  xaxis: {
      showticklabels: false
  },
  title: '{{simStat.scenario}} Total response time'
};
Plotly.newPlot('responseDiv', data, layout);

var layout2 = {
  height: 600,
  width: 1200,
  yaxis: {
    title: 'Time ms',
    type: 'log',
    zeroline: true
  },
  xaxis: {
    showticklabels: false
  },
  title: '{{simStat.startDate}} {{simStat.scenario}} Requests response time',
  showlegend: true,
  legend: {
    traceorder: 'reversed'
  }
};

var dataRequest = [];
{{#requests}}
var data{{indice}} = {
    y: {{durations}},
    boxpoints: 'all',
    jitter: 0.2,
    pointpos: -5,
    fillcolor: 'cls',
    name: '{{request}} ({{average}}ms)',
    boxmean: 'sd',
    type: 'box',
    marker:{
       size: 3,
       opacity:0.7
    }

  };
dataRequest.push(data{{indice}});
{{/requests}}
Plotly.newPlot('allDiv', dataRequest, layout2);

  </script>

</body>

